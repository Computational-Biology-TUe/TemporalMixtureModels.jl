<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple Output Variables · TemporalMixtureModels.jl</title><meta name="title" content="Multiple Output Variables · TemporalMixtureModels.jl"/><meta property="og:title" content="Multiple Output Variables · TemporalMixtureModels.jl"/><meta property="twitter:title" content="Multiple Output Variables · TemporalMixtureModels.jl"/><meta name="description" content="Documentation for TemporalMixtureModels.jl."/><meta property="og:description" content="Documentation for TemporalMixtureModels.jl."/><meta property="twitter:description" content="Documentation for TemporalMixtureModels.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="TemporalMixtureModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TemporalMixtureModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../usage/">Basic Usage</a></li><li class="is-active"><a class="tocitem" href>Multiple Output Variables</a><ul class="internal"><li><a class="tocitem" href="#Data-Preparation"><span>Data Preparation</span></a></li><li><a class="tocitem" href="#Defining-a-Composite-Component-Model"><span>Defining a Composite Component Model</span></a></li><li><a class="tocitem" href="#Fitting-the-Multivariate-Temporal-Mixture-Model"><span>Fitting the Multivariate Temporal Mixture Model</span></a></li></ul></li><li><a class="tocitem" href="../bootstrap/">Bootstrapping for Uncertainty Estimation</a></li><li><a class="tocitem" href="../custom_components/">Custom Model Components</a></li><li><a class="tocitem" href="../regularized_regression/">Regularized Regression Components</a></li><li><a class="tocitem" href="../evaluation_metrics/">Evaluation Metrics</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Multiple Output Variables</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple Output Variables</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/main/docs/src/manual/multivariate.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Multiple-Output-Variables"><a class="docs-heading-anchor" href="#Multiple-Output-Variables">Multiple Output Variables</a><a id="Multiple-Output-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Output-Variables" title="Permalink"></a></h1><p>TemporalMixtureModels.jl supports fitting mixture models to multivariate time series data with multiple output variables. Each output variable is modeled independently, within the same mixture component. This means that for each component in the mixture model, there is a separate set of parameters for each output variable, allowing the model to capture different temporal patterns for each variable, but also to capture different combinations of patterns across variables in separate mixture components.</p><pre><code class="language-julia hljs">using TemporalMixtureModels, Random
Random.seed!(27052023)  # For reproducibility</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><h2 id="Data-Preparation"><a class="docs-heading-anchor" href="#Data-Preparation">Data Preparation</a><a id="Data-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Preparation" title="Permalink"></a></h2><p>When preparing your data for multivariate time series modeling, the format is similar to that of univariate time series, with the key difference being that the observed values <code>Y</code> should be a matrix where each column corresponds to a different output variable. Each row still corresponds to a time point in <code>t</code>, and the <code>ids</code> vector indicates which time series each observation belongs to. </p><p>The example dataset provided by the <code>example_bp_data()</code> function includes two output variables: systolic and diastolic blood pressure measurements. You can use this function to generate a multivariate dataset as follows:</p><pre><code class="language-julia hljs">t, y, ids, class_labels = example_bp_data(;n_subjects_drug=21, n_subjects_placebo=22, n_timepoints=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0, 1.25, 2.5, 3.75, 5.0, 0.0, 1.25, 2.5, 3.75, 5.0  …  0.0, 1.25, 2.5, 3.75, 5.0, 0.0, 1.25, 2.5, 3.75, 5.0], [125.48572170434635 82.70734137033764; 103.06459556000243 71.3956312347923; … ; 109.19769689115391 71.89320129586659; 108.0637238450581 77.0854240014355], [1, 1, 1, 1, 1, 2, 2, 2, 2, 2  …  42, 42, 42, 42, 42, 43, 43, 43, 43, 43], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><h2 id="Defining-a-Composite-Component-Model"><a class="docs-heading-anchor" href="#Defining-a-Composite-Component-Model">Defining a Composite Component Model</a><a id="Defining-a-Composite-Component-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-a-Composite-Component-Model" title="Permalink"></a></h2><p>As the <code>PolynomialRegression</code> component only supports a single output variable, we need to define a composite component model that combines multiple <code>PolynomialRegression</code> models, one for each output variable. Creation of a composite component model is very straightforward using the <code>@component</code> macro.</p><pre><code class="language-julia hljs">component_model = @component begin
    y[1] ~ PolynomialRegression(2)
    y[2] ~ PolynomialRegression(2)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CompositeComponent(Component[PolynomialRegression(2), PolynomialRegression(2)], UnitRange{Int64}[1:3, 4:6], UnitRange{Int64}[1:1, 2:2])</code></pre><p>This composite model specifies that the first output variable (<code>y[1]</code>, systolic pressure) is modeled using a polynomial regression of degree 2, and the second output variable (<code>y[2]</code>, diastolic pressure) is also modeled using a polynomial regression of degree 2. The <code>@component</code> macro is sufficiently flexible to allow for different types of component models for each output variable if desired. </p><article><details class="docstring" open="true"><summary id="TemporalMixtureModels.@component"><a class="docstring-binding" href="#TemporalMixtureModels.@component"><code>TemporalMixtureModels.@component</code></a> — <span class="docstring-category">Macro</span></summary><section><div><pre><code class="language-julia hljs">@component begin ... end</code></pre><p>The <code>@component</code> macro allows defining a <code>CompositeComponent</code> in a concise way. We use composite components to connect component models to specific measurements in multivariate data. Each line inside the <code>begin ... end</code> block should specify a mapping from a measurement (or range of measurements) to a component model using the syntax </p><pre><code class="language-julia hljs">y[index] ~ ComponentModel(args...)</code></pre><p>All indices refer to the <em>columns</em> of the observation matrix <code>y</code>. The macro collects all specified components and their corresponding measurement indices, and constructs a <code>CompositeComponent</code> instance. The resulting <code>CompositeComponent</code> can then be used in mixture model fitting, in the same way as regular components.</p><p><strong>Example</strong></p><p><strong>Simple Composite Component</strong></p><pre><code class="language-julia hljs">using TemporalMixtureModels

component = @component begin
    y[1] ~ PolynomialRegression(2)  # Quadratic for measurement 1
    y[2] ~ PolynomialRegression(3)  # Cubic for measurement 2
end</code></pre><p><strong>Composite Component with Ranges</strong></p><p>While the <code>PolynomialRegression</code> component only models a single measurement, you can also use components that model multiple measurements at once. For example, if you have a bivariate measurement that you want to model with a single component (here abstracted as <code>BivariateComponent</code>), you can specify a range of indices:</p><pre><code class="language-julia hljs">using TemporalMixtureModels

component = @component begin
    y[1] ~ PolynomialRegression(2)  # Quadratic for measurement 1
    y[2:3] ~ BivariateComponent()  # A bivariate component for measurements 2 and 3
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/ea3ed123caba5fbb988088f72a8f014bbc1735dc/src/composition.jl#L62-L95">source</a></section></details></article><h2 id="Fitting-the-Multivariate-Temporal-Mixture-Model"><a class="docs-heading-anchor" href="#Fitting-the-Multivariate-Temporal-Mixture-Model">Fitting the Multivariate Temporal Mixture Model</a><a id="Fitting-the-Multivariate-Temporal-Mixture-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-the-Multivariate-Temporal-Mixture-Model" title="Permalink"></a></h2><p>Once you have defined your composite component model, you can fit the multivariate temporal mixture model using the <code>fit_mixture</code> function, just like in the univariate case. You need to specify the number of components (clusters) you want to fit, as well as the composite component model to use.</p><pre><code class="language-julia hljs">num_components = 2  # For example, we want to fit 2 clusters
model = fit_mixture(component_model, num_components, t, y, ids)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixtureResult(CompositeComponent(Component[PolynomialRegression(2), PolynomialRegression(2)], UnitRange{Int64}[1:3, 4:6], UnitRange{Int64}[1:1, 2:2]), 2, [[121.94443228135796, 0.3448095076792161, -0.0904306737635472, 78.76238884028707, -0.473053295564207, 0.09185031783869191], [119.97366434856283, -7.911874318141266, 0.6336783991887212, 80.62956871083868, -7.602305525382226, 0.8123489480159889]], [[62.46925627070032, 18.311570008681848], [95.33020222464681, 25.07712577768433]], [0.5109507077757636, 0.4890492922242365], [1.532459139684492e-8 0.9999999846754086; 1.358618544187119e-13 0.9999999999998641; … ; 0.9999999995003488 4.99651185218339e-10; 0.9708879657344872 0.02911203426551288], -1435.5953080617164, true, 7, NormalError())</code></pre><p>This will fit a temporal mixture model with 2 components, each consisting of two polynomial regression models (one for each output variable) of degree 2 to the multivariate blood pressure data. </p><p>We can now use the fitted model to make predictions for new time points, just like in the univariate case. </p><p>An example of the resulting mixture model is shown below:</p><p><img src="../multivariate_mixture_model.png" alt="Multivariate Mixture Model"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Basic Usage</a><a class="docs-footer-nextpage" href="../bootstrap/">Bootstrapping for Uncertainty Estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 13:44">Wednesday 26 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
