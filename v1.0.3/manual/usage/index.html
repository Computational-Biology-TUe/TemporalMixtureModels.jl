<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Usage · TemporalMixtureModels.jl</title><meta name="title" content="Basic Usage · TemporalMixtureModels.jl"/><meta property="og:title" content="Basic Usage · TemporalMixtureModels.jl"/><meta property="twitter:title" content="Basic Usage · TemporalMixtureModels.jl"/><meta name="description" content="Documentation for TemporalMixtureModels.jl."/><meta property="og:description" content="Documentation for TemporalMixtureModels.jl."/><meta property="twitter:description" content="Documentation for TemporalMixtureModels.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="TemporalMixtureModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TemporalMixtureModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Basic Usage</a><ul class="internal"><li><a class="tocitem" href="#Data-Preparation"><span>Data Preparation</span></a></li><li><a class="tocitem" href="#Fitting-a-Temporal-Mixture-Model"><span>Fitting a Temporal Mixture Model</span></a></li><li><a class="tocitem" href="#Making-Predictions"><span>Making Predictions</span></a></li></ul></li><li><a class="tocitem" href="../multivariate/">Multiple Output Variables</a></li><li><a class="tocitem" href="../bootstrap/">Bootstrapping for Uncertainty Estimation</a></li><li><a class="tocitem" href="../custom_components/">Custom Model Components</a></li><li><a class="tocitem" href="../regularized_regression/">Regularized Regression Components</a></li><li><a class="tocitem" href="../evaluation_metrics/">Evaluation Metrics</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Basic Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic Usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/main/docs/src/manual/usage.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Usage-of-TemporalMixtureModels.jl"><a class="docs-heading-anchor" href="#Basic-Usage-of-TemporalMixtureModels.jl">Basic Usage of TemporalMixtureModels.jl</a><a id="Basic-Usage-of-TemporalMixtureModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage-of-TemporalMixtureModels.jl" title="Permalink"></a></h1><p>The main functionality revolves around the <code>fit_mixture</code> function, which fits a temporal mixture model to the provided time series data, using the EM algorithm.</p><p>First, we need to import the package:</p><pre><code class="language-julia hljs">using TemporalMixtureModels, Random
Random.seed!(27052023)  # For reproducibility</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><h2 id="Data-Preparation"><a class="docs-heading-anchor" href="#Data-Preparation">Data Preparation</a><a id="Data-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Preparation" title="Permalink"></a></h2><p>First of all, you&#39;ll need some data that is in the right format. The basic format for the data consists of three elements:</p><ul><li><code>t</code>: A vector of time points. This should be a one-dimensional array of real numbers representing the time axis for the time series data.</li><li><code>Y</code>: A vector or matrix of observed values. Each row corresponds to a time point in <code>t</code>, and each column corresponds to a different outcome variable (for multivariate time series). For univariate time series, this can be a one-dimensional array.</li><li><code>ids</code>: A vector of identifiers for each independent time series. The length of this vector should match the number of rows in <code>Y</code> and indicates which time series each observation belongs to.</li></ul><p>Optionally, you can also provide:</p><ul><li><code>inputs</code>: A matrix of input variables (covariates) that may influence the observed values. Each row corresponds to a time point, and each column corresponds to a different input variable. Inputs are currently not used in the built-in component models, but the support is there for custom models.</li></ul><p>Say, we have a dataset with blood pressure measurements over time for multiple patients while they have been given either a placebo or a drug. Our table of data might look like this:</p><table><tr><th style="text-align: right">id</th><th style="text-align: right">time</th><th style="text-align: right">systolic_pressure</th><th style="text-align: right">diastolic_pressure</th><th style="text-align: right">treatment</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">0.0</td><td style="text-align: right">120</td><td style="text-align: right">80</td><td style="text-align: right">drug</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">1.0</td><td style="text-align: right">118</td><td style="text-align: right">78</td><td style="text-align: right">drug</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">2.0</td><td style="text-align: right">115</td><td style="text-align: right">75</td><td style="text-align: right">drug</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">0.0</td><td style="text-align: right">130</td><td style="text-align: right">85</td><td style="text-align: right">placebo</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">1.0</td><td style="text-align: right">128</td><td style="text-align: right">83</td><td style="text-align: right">placebo</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">2.0</td><td style="text-align: right">125</td><td style="text-align: right">80</td><td style="text-align: right">placebo</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">43</td><td style="text-align: right">2.0</td><td style="text-align: right">110</td><td style="text-align: right">70</td><td style="text-align: right">placebo</td></tr></table><p>For the examples in the manual, the package contains a function called <code>example_bp_data()</code> that can be used to generate a dataset like this.</p><article><details class="docstring" open="true"><summary id="TemporalMixtureModels.example_bp_data"><a class="docstring-binding" href="#TemporalMixtureModels.example_bp_data"><code>TemporalMixtureModels.example_bp_data</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">example_bp_data(;n_subjects_drug=50, n_subjects_placebo=50, n_timepoints=5, rng::AbstractRNG=Random.GLOBAL_RNG)</code></pre><p>Generate example blood pressure data for testing and examples.</p><p><strong>Arguments</strong></p><ul><li><code>n_subjects_drug</code>: Number of subjects in the drug group (default: 50)</li><li><code>n_subjects_placebo</code>: Number of subjects in the placebo group (default: 50)</li><li><code>n_timepoints</code>: Number of time points per subject (default: 5)</li><li><code>rng</code>: Random number generator (default: <code>Random.GLOBAL_RNG</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>t</code>: Vector of time points</li><li><code>y</code>: Matrix of blood pressure measurements (systolic and diastolic)</li><li><code>ids</code>: Vector of subject IDs</li><li><code>class_labels</code>: Vector of class labels (1 for drug, 0 for placebo)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using TemporalMixtureModels: example_bp_data
t, y, ids, class_labels = example_bp_data(n_subjects_drug=30, n_subjects_placebo=30, n_timepoints=4)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/ea3ed123caba5fbb988088f72a8f014bbc1735dc/src/data.jl#L97-L119">source</a></section></details></article><p>Let&#39;s generate the example blood pressure dataset:</p><pre><code class="language-julia hljs">t, y, ids, class_labels = example_bp_data(;n_subjects_drug=21, n_subjects_placebo=22, n_timepoints=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0, 1.25, 2.5, 3.75, 5.0, 0.0, 1.25, 2.5, 3.75, 5.0  …  0.0, 1.25, 2.5, 3.75, 5.0, 0.0, 1.25, 2.5, 3.75, 5.0], [125.48572170434635 82.70734137033764; 103.06459556000243 71.3956312347923; … ; 109.19769689115391 71.89320129586659; 108.0637238450581 77.0854240014355], [1, 1, 1, 1, 1, 2, 2, 2, 2, 2  …  42, 42, 42, 42, 42, 43, 43, 43, 43, 43], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</code></pre><p>We can quickly visualize the systolic blood pressure measurements over time for all subjects:</p><p><img src="../systolic_bp_plot.png" alt="systolic_bp_plot"/></p><div class="admonition is-info" id="Missing-Data-ecba3c37b894a984"><header class="admonition-header">Missing Data<a class="admonition-anchor" href="#Missing-Data-ecba3c37b894a984" title="Permalink"></a></header><div class="admonition-body"><p>It may occur that some time series have missing values at certain time points. The current implementation of <code>fit_mixture</code> handles missing data by ignoring those specific observations during the fitting process. </p><p>This may for example also happen if you measure two variables that are not always both measured at the same time points. In that case, you can fill the missing values with <code>missing</code> and the fitting process will skip those values. <code>TemporalMixtureModels.jl</code> is designed to handle such cases gracefully.</p><p>An example of such a dataset, where we may measure systolic pressure at the start and after 1 hour, while we diastolic pressure at the start and at 2 hours, would look like this:</p><table><tr><th style="text-align: right">id</th><th style="text-align: right">time</th><th style="text-align: right">systolic_pressure</th><th style="text-align: right">diastolic_pressure</th><th style="text-align: right">treatment</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">0.0</td><td style="text-align: right">120</td><td style="text-align: right">80</td><td style="text-align: right">drug</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">1.0</td><td style="text-align: right">118</td><td style="text-align: right">missing</td><td style="text-align: right">drug</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">2.0</td><td style="text-align: right">missing</td><td style="text-align: right">75</td><td style="text-align: right">drug</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">0.0</td><td style="text-align: right">130</td><td style="text-align: right">85</td><td style="text-align: right">placebo</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">1.0</td><td style="text-align: right">128</td><td style="text-align: right">missing</td><td style="text-align: right">placebo</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">2.0</td><td style="text-align: right">missing</td><td style="text-align: right">80</td><td style="text-align: right">placebo</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">43</td><td style="text-align: right">2.0</td><td style="text-align: right">missing</td><td style="text-align: right">70</td><td style="text-align: right">placebo</td></tr></table><p>As long as we have enough data points overall, the fitting process will still work.</p></div></div><h2 id="Fitting-a-Temporal-Mixture-Model"><a class="docs-heading-anchor" href="#Fitting-a-Temporal-Mixture-Model">Fitting a Temporal Mixture Model</a><a id="Fitting-a-Temporal-Mixture-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-a-Temporal-Mixture-Model" title="Permalink"></a></h2><p>Once you have your data prepared, you can fit a temporal mixture model using the <code>fit_mixture</code> function. You need to specify the number of components (clusters) you want to fit, as well as the component model to use (e.g., <code>PolynomialRegression</code>). For now, we are interested in the systolic pressure only, so we will extract that column from <code>Y</code> for fitting.</p><pre><code class="language-julia hljs">component_model = PolynomialRegression(2)
num_components = 2  # For example, we want to fit 2 clusters
model = fit_mixture(component_model, num_components, t, y[:, 1], ids)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MixtureResult(PolynomialRegression(2), 2, [[119.34891353034865, -7.2868884094666875, 0.5764883810632598], [122.7913507650051, 0.2949062907715054, -0.08341428634647943]], [[94.96960000162001], [59.68091478886761]], [0.5259997562454423, 0.4740002437545577], [0.9999979104182807 2.0895817192977623e-6; 0.9999998337442878 1.6625571223359278e-7; … ; 0.0004310743373957102 0.9995689256626042; 0.9393909635620004 0.06060903643799958], -797.0558338777277, true, 30, NormalError())</code></pre><p>This will fit a temporal mixture model with 2 polynomial regression components of degree 2 to the systolic blood pressure data. </p><h3 id="The-Polynomial-Regression-Component"><a class="docs-heading-anchor" href="#The-Polynomial-Regression-Component">The Polynomial Regression Component</a><a id="The-Polynomial-Regression-Component-1"></a><a class="docs-heading-anchor-permalink" href="#The-Polynomial-Regression-Component" title="Permalink"></a></h3><p>The <code>PolynomialRegression</code> component model fits a polynomial regression of a specified degree to the time series data. In this example, we used a polynomial of degree 2, which means that each component will fit a quadratic curve to the data. You can choose different degrees based on the complexity of the temporal patterns you expect in your data.</p><article><details class="docstring" open="true"><summary id="TemporalMixtureModels.PolynomialRegression"><a class="docstring-binding" href="#TemporalMixtureModels.PolynomialRegression"><code>TemporalMixtureModels.PolynomialRegression</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PolynomialRegression(degree::Int)</code></pre><p>Polynomial regression component model.</p><p><strong>Arguments</strong></p><ul><li><code>degree</code>: Polynomial degree (e.g., 2 for quadratic)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/ea3ed123caba5fbb988088f72a8f014bbc1735dc/src/components/regression.jl#L4-L11">source</a></section></details></article><h3 id="Customizing-the-fitting-process"><a class="docs-heading-anchor" href="#Customizing-the-fitting-process">Customizing the fitting process</a><a id="Customizing-the-fitting-process-1"></a><a class="docs-heading-anchor-permalink" href="#Customizing-the-fitting-process" title="Permalink"></a></h3><p>The <code>fit_mixture</code> function provides several optional keyword arguments to customize the fitting process:</p><article><details class="docstring" open="true"><summary id="TemporalMixtureModels.fit_mixture"><a class="docstring-binding" href="#TemporalMixtureModels.fit_mixture"><code>TemporalMixtureModels.fit_mixture</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_mixture(component, n_components, t, y, ids;
            n_repeats=5, error_model=NormalError(), inputs=nothing, 
            max_iter=100, tol=1e-6, verbose=true, initial_assignments=nothing)</code></pre><p>Fit a mixture model using the Expectation-Maximization (EM) algorithm. By default, <code>fit_mixture</code> will run 5 EM restarts and return the best fitting model based on log-likelihood.</p><p><strong>Arguments</strong></p><ul><li><code>component</code>: A Component model (e.g., PolynomialRegression(2))</li><li><code>n_components</code>: Number of mixture components/clusters</li><li><code>t</code>: Time points (vector)</li><li><code>y</code>: Measurements (vector for single measurement, matrix for multiple)</li><li><code>ids</code>: Subject identifiers (vector)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>n_repeats</code>: Number of EM restarts (default: 5)</li><li><code>error_model</code>: Error distribution (currently only NormalError() is supported, included for possible future extensions)</li><li><code>inputs</code>: Additional input variables to be passed to the component model (default: nothing)</li><li><code>max_iter</code>: Maximum EM iterations (default: 100)</li><li><code>tol</code>: Convergence tolerance (default: 1e-6)</li><li><code>verbose</code>: Print progress (default: true)</li><li><code>initial_assignments</code>: Optional vector of initial cluster assignments (1 to n_components) for each subject (default: nothing, uses random initialization)</li></ul><p><strong>Returns</strong></p><ul><li><code>MixtureResult</code> containing fitted parameters and cluster assignments, with fields:<ul><li><code>component</code>: The component model used</li><li><code>n_clusters</code>: Number of clusters</li><li><code>parameters</code>: Fitted parameters for each cluster</li><li><code>params_error</code>: Estimated error model parameters for each measurement and cluster</li><li><code>cluster_probs</code>: Mixing proportions for each cluster</li><li><code>responsibilities</code>: Posterior responsibilities for each subject and cluster</li><li><code>loglikelihood</code>: Final log-likelihood of the fitted model</li><li><code>converged</code>: Boolean indicating if the EM algorithm converged</li><li><code>n_iterations</code>: Number of iterations performed</li><li><code>error_model</code>: The error model used</li></ul></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Single measurement with normal errors
result = fit_mixture(PolynomialRegression(2), 3, t, y, ids)

# With initial cluster assignments
initial_clusters = [1, 1, 2, 2, 3, 3]  # subjects 1-2 in cluster 1, 3-4 in cluster 2, etc.
result = fit_mixture(PolynomialRegression(2), 3, t, y, ids; initial_assignments=initial_clusters)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/ea3ed123caba5fbb988088f72a8f014bbc1735dc/src/solve.jl#L461-L506">source</a></section></details></article><h2 id="Making-Predictions"><a class="docs-heading-anchor" href="#Making-Predictions">Making Predictions</a><a id="Making-Predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Making-Predictions" title="Permalink"></a></h2><p>After fitting the model, you can make predictions for new time points using the <code>predict</code> function. You can specify the time points at which you want predictions, and the function will return the predicted values for each component.</p><pre><code class="language-julia hljs">new_time_points = 0:0.1:2.0
predictions = predict(model, new_time_points)</code></pre><p>An example of the resulting mixture model is shown below:</p><p><img src="../systolic_bp_mixture_model.png" alt="systolic_bp_mixture_model"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../multivariate/">Multiple Output Variables »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 13:44">Wednesday 26 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
