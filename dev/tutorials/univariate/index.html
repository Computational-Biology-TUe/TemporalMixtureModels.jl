<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Univariate · TemporalMixtureModels.jl</title><meta name="title" content="Univariate · TemporalMixtureModels.jl"/><meta property="og:title" content="Univariate · TemporalMixtureModels.jl"/><meta property="twitter:title" content="Univariate · TemporalMixtureModels.jl"/><meta name="description" content="Documentation for TemporalMixtureModels.jl."/><meta property="og:description" content="Documentation for TemporalMixtureModels.jl."/><meta property="twitter:description" content="Documentation for TemporalMixtureModels.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="TemporalMixtureModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TemporalMixtureModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Univariate</a><ul class="internal"><li><a class="tocitem" href="#Prerequisites"><span>Prerequisites</span></a></li><li><a class="tocitem" href="#Generating-Synthetic-Data"><span>Generating Synthetic Data</span></a></li><li><a class="tocitem" href="#Fitting-a-Temporal-Mixture-Model"><span>Fitting a Temporal Mixture Model</span></a></li></ul></li><li><a class="tocitem" href="../multivariate/">Multivariate</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../api/components/">Model Components</a></li><li><a class="tocitem" href="../../api/mixtures/">Mixture Models</a></li><li><a class="tocitem" href="../../api/fitting/">Fitting Models</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Univariate</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Univariate</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Computational-Biology-TUe/TemporalMixtureModels.jl/blob/main/docs/src/tutorials/univariate.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Univariate-Model"><a class="docs-heading-anchor" href="#Univariate-Model">Univariate Model</a><a id="Univariate-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-Model" title="Permalink"></a></h1><p>This tutorial provides a step-by-step guide on how to use the <code>TemporalMixtureModels.jl</code> package to fit temporal mixture models to time series data. It provides a simple example using synthetic data to illustrate the main functionalities of the package, including data preparation, model fitting, prediction, and uncertainty estimation.</p><h2 id="Prerequisites"><a class="docs-heading-anchor" href="#Prerequisites">Prerequisites</a><a id="Prerequisites-1"></a><a class="docs-heading-anchor-permalink" href="#Prerequisites" title="Permalink"></a></h2><p>While the package uses an internal data structure for the time series data, the package by default implements automatic conversion from a <code>DataFrame</code> to its internal format. </p><pre><code class="language-julia hljs">using TemporalMixtureModels, DataFrames</code></pre><h2 id="Generating-Synthetic-Data"><a class="docs-heading-anchor" href="#Generating-Synthetic-Data">Generating Synthetic Data</a><a id="Generating-Synthetic-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-Synthetic-Data" title="Permalink"></a></h2><p>For this tutorial, we will generate synthetic univariate time series data. The data will consist of three clusters, each generated from a different polynomial function with added Gaussian noise. The input DataFrame should be a so-called &quot;long&quot; format, with columns for the individual ID, time points, and observed values. </p><pre><code class="language-julia hljs"># Set random seed for reproducibility
using Random
Random.seed!(1234)

# Generate time points
individuals_per_group = [20, 30]
t_values = 0:0.1:10
n_groups = 2

group_coefficients = [ [2.0, -0.5, 0.05],  # Group 1: y = 2 - 0.5*t + 0.05*t^2
                       [1.0, 0.3, -0.02] ] # Group 2: y = 1 + 0.3*t - 0.02*t^2

ids = Int[]
timepoints = Float64[]
measurements = Float64[]
for group in 1:n_groups
    id_start = sum(individuals_per_group[1:group-1]) + 1
    id_end = sum(individuals_per_group[1:group])
    for individual in id_start:id_end
        for t in t_values
            y = group_coefficients[group][1] + group_coefficients[group][2]*t + group_coefficients[group][3]*t^2 + randn()*0.25
            push!(ids, individual)
            push!(timepoints, t)
            push!(measurements, y)
        end
    end
end

input_data = DataFrame(id = ids, time = timepoints, value = measurements)
first(input_data, 5)  # Display the first 5 rows of the DataFrame</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">id</th><th style = "text-align: left;">time</th><th style = "text-align: left;">value</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">1.91007</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">2.2223</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.2</td><td style = "text-align: right;">1.7971</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.3</td><td style = "text-align: right;">2.03423</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.4</td><td style = "text-align: right;">1.91306</td></tr></tbody></table></div><p>Here you can see the first few rows of the generated DataFrame. Each row corresponds to a measurement for a specific individual at a specific time point. The internal structure of the model takes care of the bookkeeping during the fitting process.</p><h2 id="Fitting-a-Temporal-Mixture-Model"><a class="docs-heading-anchor" href="#Fitting-a-Temporal-Mixture-Model">Fitting a Temporal Mixture Model</a><a id="Fitting-a-Temporal-Mixture-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-a-Temporal-Mixture-Model" title="Permalink"></a></h2><p>Now that we have our synthetic data, we can fit a temporal mixture model using the <code>fit!</code> function. We will use a polynomial regression model as the component model for this example. We will specify the number of components (clusters) we expect in the data.</p><p>We first define the model, specifying the number of components and the type of component model to use. In this case, we will use a polynomial regression model of degree 2.</p><pre><code class="language-julia hljs"># Define the number of components and the component model
n_components = 2
component_model = PolynomialRegression(2)
model = UnivariateMixtureModel(n_components, component_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">UnivariateMixtureModel{Float64}(TemporalMixtureModels.AbstractMixtureModelComponent{Float64}[PolynomialRegression{Float64}(2, [0.0, 0.0, 0.0]), PolynomialRegression{Float64}(2, [0.0, 0.0, 0.0])], [0.5, 0.5], [0.0, 0.0], -Inf, false, 0)</code></pre><p>We can now fit the model to our data using the <code>fit!</code> function. This function takes the model and the input DataFrame as arguments and performs the fitting process.</p><pre><code class="language-julia hljs"># Fit the model to the data
fit!(model, input_data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">UnivariateMixtureModel{Float64}(TemporalMixtureModels.AbstractMixtureModelComponent{Float64}[PolynomialRegression{Float64}(2, [1.9918590501073516, -0.49286490747138556, 0.049279349186218915]), PolynomialRegression{Float64}(2, [0.989186937982434, 0.3062137555464907, -0.020612764194961962])], [0.4, 0.6], [0.062871976937173, 0.06294039234699463], -212.13465861833342, true, 3)</code></pre><p>We can also compute the confidence intervals for the model parameters using bootstrap resampling. This provides an estimate of the uncertainty in the parameter estimates.</p><pre><code class="language-julia hljs"># Compute bootstrap confidence intervals
n_bootstrap = 100  # Number of bootstrap samples
confidence_intervals, _ = bootstrap_ci(model, input_data; n_bootstrap=n_bootstrap)
confidence_intervals</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Any}:
 (lower = [1.9619378486909782, -0.5040298747290615, 0.04810395842021009], upper = [2.026180513936858, -0.4808429504588593, 0.05013344858781813])
 (lower = [0.9544293489367097, 0.2927516811190185, -0.022293345025492427], upper = [1.0128094093921465, 0.3224244442686258, -0.01927421348782255])</code></pre><p>The output shows the confidence intervals for the parameters of each component model in the mixture. We can use these intervals and the fitted model to visualize the results.</p><pre><code class="language-julia hljs">using CairoMakie

# Create a range of time points for prediction
t_pred = 0:0.1:10

# Prepare a figure
figure_mixture = let f = Figure()
    ax = Axis(f[1, 1], xlabel=&quot;Time&quot;, ylabel=&quot;Value&quot;, title=&quot;Temporal Mixture Model Fit&quot;)

    # Plot the original data points
    scatter!(ax, input_data.time, input_data.value; color=:gray, markersize=4, label=&quot;Data&quot;)

    # Plot the fitted component models
    predictions = predict(model, t_pred)

    COMPONENT_COLORS = [colorant&quot;#c74300&quot;, colorant&quot;#008aa1&quot;]

    for k in axes(predictions, 2)
        lines!(ax, t_pred, predictions[:, k];
        label=&quot;Component $k&quot;, color=COMPONENT_COLORS[k], linewidth=2)

        # get the confidence bounds. This is still a bit clunky because there is no API for this yet
        lower_bound_parameters = confidence_intervals[k][:lower]
        upper_bound_parameters = confidence_intervals[k][:upper]

        model_lb = PolynomialRegression(2, lower_bound_parameters)
        model_ub = PolynomialRegression(2, upper_bound_parameters)

        y_lower = predict(model_lb, t_pred)
        y_upper = predict(model_ub, t_pred)

        # Plot the confidence intervals as shaded areas
        band!(ax, t_pred, y_lower, y_upper;
        color=(COMPONENT_COLORS[k], 0.2), label=&quot;Component $k&quot;)
    end

    axislegend(ax; merge=true)

    f
end
figure_mixture</code></pre><img src="663c3ea2.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Getting Started</a><a class="docs-footer-nextpage" href="../multivariate/">Multivariate »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 29 September 2025 13:26">Monday 29 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
